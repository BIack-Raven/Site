<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financement de Projets Audiovisuels</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        select, button, input {
            padding: 8px;
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <h1>Financement de Projets Audiovisuels</h1>

    <div>
        <label for="regionFilter">Région:</label>
        <select id="regionFilter">
            <option value="">Toutes</option>
            <!-- Les options seront dynamiquement remplies via JavaScript -->
        </select>

        <label for="formatFilter">Format:</label>
        <select id="formatFilter">
            <option value="">Tous</option>
            <!-- Options pour filtrer par format -->
        </select>

        <button onclick="filterTable()">Filtrer</button>
    </div>

    <div id="festivals-list"></div>

    <h2>Ajouter un Festival</h2>
    <form id="addFestivalForm">
        <input type="text" id="Nom" placeholder="Nom" required><br>
        <input type="text" id="Pays" placeholder="Pays" required><br>
        <input type="text" id="Format" placeholder="Format" required><br>
        <button type="submit">Ajouter</button>
    </form>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
    <script>
        // Initialiser Supabase
        const supabaseUrl = 'https://aws-1-eu-west-3.pooler.supabase.com';
        const supabaseKey = '4pAh9U7epJLFCftu'; // Assurez-vous de protéger cette clé et ne la partagez pas publiquement
        const supabase = supabase.createClient(supabaseUrl, supabaseKey);

        async function loadFestivals() {
            const { data, error } = await supabase
                .from('festivals')
                .select('*');

            if (error) {
                console.error('Error fetching festivals:', error);
            } else {
                const list = document.getElementById('festivals-list');
                list.innerHTML = data.map(festival =>
                    `<div>${festival.Nom} - ${festival.Pays} (${festival.Format})</div>`
                ).join('');
            }
        }

        document.getElementById('addFestivalForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const newFestival = {
                Nom: document.getElementById('Nom').value,
                Pays: document.getElementById('Pays').value,
                Format: document.getElementById('Format').value,
                // Ajoutez d'autres champs ici
            };

            const { data, error } = await supabase
                .from('festivals')
                .insert([newFestival]);

            if (error) {
                console.error('Error adding festival:', error);
            } else {
                await loadFestivals();
            }
        });

        loadFestivals();
    </script>
</body>
</html>
